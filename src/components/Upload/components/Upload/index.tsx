import { useMemo } from "react";
import { FileProgress } from "../../interface";
import { UPLOAD_STATUS } from "../../constants";
import { ActionButton } from "../ActionButton";
import { ActionContainer } from "../ActionContainer";

type UploadProps = {
  upload: FileProgress;
  retryUpload: () => void;
  deleteUpload: () => void;
};

const Upload = ({ upload, retryUpload, deleteUpload }: UploadProps) => {
  const renderIcon = useMemo(() => {
    const cancelUpload = () => {
      upload.controller.abort("User cancelled file upload");
    };

    switch (upload.status) {
      case UPLOAD_STATUS.uploading:
        return (
          <ActionContainer>
            <ActionButton action={cancelUpload}>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
              >
                <path
                  opacity="0.3"
                  d="M10 2C5.59 2 2 5.59 2 10C2 14.41 5.59 18 10 18C14.41 18 18 14.41 18 10C18 5.59 14.41 2 10 2ZM9 14H7V6H9V14ZM13 14H11V6H13V14Z"
                  fill="#6D6D6D"
                />
                <path d="M13 6H11V14H13V6Z" fill="#6D6D6D" />
                <path d="M9 6H7V14H9V6Z" fill="#6D6D6D" />
                <path
                  d="M10 0C4.48 0 0 4.48 0 10C0 15.52 4.48 20 10 20C15.52 20 20 15.52 20 10C20 4.48 15.52 0 10 0ZM10 18C5.59 18 2 14.41 2 10C2 5.59 5.59 2 10 2C14.41 2 18 5.59 18 10C18 14.41 14.41 18 10 18Z"
                  fill="#6D6D6D"
                />
              </svg>
            </ActionButton>
            <ActionButton action={cancelUpload}>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                viewBox="0 0 16 16"
                fill="none"
              >
                <path
                  d="M8 16C5.87833 16 3.84331 15.1571 2.34315 13.6568C0.842901 12.1565 0 10.1217 0 8C0 5.87833 0.842901 3.84332 2.34315 2.34315C3.84353 0.842902 5.87833 0 8 0C10.1217 0 12.1567 0.842902 13.6568 2.34315C15.1571 3.84353 16 5.87833 16 8C15.9974 10.121 15.1538 12.1545 13.654 13.654C12.1543 15.1538 10.1207 15.9974 8 16ZM11.0851 5.94242V5.9423C11.2254 5.80678 11.3053 5.62063 11.3071 5.42558C11.3088 5.23053 11.2321 5.04292 11.0941 4.90496C10.9562 4.76701 10.7685 4.69031 10.5735 4.69202C10.3784 4.69372 10.1923 4.77371 10.0568 4.91397L8 6.97149L5.94323 4.91397C5.75853 4.7356 5.49346 4.66779 5.2457 4.73572C4.99805 4.80366 4.8046 4.99713 4.73665 5.24477C4.66871 5.49254 4.73653 5.7576 4.9149 5.9423L6.97167 7.99983L4.9149 10.0573C4.77464 10.1929 4.69465 10.379 4.69294 10.5741C4.69124 10.7691 4.76794 10.9567 4.90589 11.0947C5.04383 11.2326 5.23145 11.3093 5.4265 11.3076C5.62155 11.3059 5.8077 11.2259 5.94322 11.0857L7.99999 9.02815L10.0568 11.0857C10.1923 11.2259 10.3784 11.3059 10.5735 11.3076C10.7685 11.3093 10.9561 11.2326 11.0941 11.0947C11.2321 10.9567 11.3088 10.7691 11.307 10.5741C11.3053 10.379 11.2253 10.1929 11.0851 10.0573L9.02832 7.99983L11.0851 5.94242Z"
                  fill="#E6E6E6"
                />
              </svg>
            </ActionButton>
          </ActionContainer>
        );
      case UPLOAD_STATUS.success:
        return (
          <ActionContainer>
            <ActionButton action={deleteUpload}>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                viewBox="0 0 16 16"
                fill="none"
              >
                <circle cx="8" cy="8" r="8" fill="#FFF3F3" />
                <path
                  d="M11.4769 5.14517H10.4774C10.464 5.14054 10.4501 5.13753 10.436 5.13614H9.37174V4.25348C9.3718 4.18714 9.3458 4.12346 9.29945 4.07608C9.25304 4.02871 9.18995 4.00138 9.12369 4H6.60672C6.53948 4 6.47501 4.02667 6.42752 4.07422C6.37997 4.12177 6.35324 4.18624 6.35324 4.25348V5.13614H5.29439C5.2803 5.13753 5.2664 5.14054 5.25303 5.14517H4.25347C4.16288 5.14517 4.07921 5.19345 4.03395 5.27188C3.98868 5.35031 3.98868 5.44691 4.03395 5.52535C4.07921 5.60378 4.16288 5.65211 4.25347 5.65211H5.06783L5.72585 11.7735C5.7329 11.8358 5.76263 11.8933 5.8094 11.9351C5.85611 11.9769 5.91661 11.9999 5.97932 12H9.75462C9.81668 11.9991 9.87627 11.9756 9.92233 11.9339C9.96831 11.8922 9.99751 11.8352 10.0045 11.7735L10.6625 5.66105H11.4769C11.5675 5.66105 11.6511 5.61277 11.6964 5.53434C11.7417 5.45591 11.7417 5.35924 11.6964 5.28087C11.6511 5.20244 11.5675 5.1541 11.4769 5.1541L11.4769 5.14517ZM6.86566 4.50695H8.86472V5.13614H6.86566V4.50695ZM9.52455 11.4894H6.20582L5.57663 5.66111H10.1537L9.52455 11.4894Z"
                  fill="#E41D1D"
                />
                <path
                  d="M7.86529 10.8962C7.93252 10.8962 7.99699 10.8695 8.04454 10.822C8.09209 10.7745 8.11876 10.71 8.11876 10.6428V6.50796C8.11876 6.41737 8.07049 6.33369 7.99205 6.28843C7.91362 6.24311 7.81696 6.24311 7.73852 6.28843C7.66009 6.3337 7.61182 6.41737 7.61182 6.50796V10.6428C7.61182 10.71 7.63848 10.7745 7.68603 10.822C7.73359 10.8695 7.79805 10.8962 7.86529 10.8962H7.86529Z"
                  fill="#E41D1D"
                />
                <path
                  d="M6.8674 10.8944H6.87817C6.94511 10.8916 7.00819 10.8624 7.0537 10.8132C7.09915 10.7641 7.12334 10.6989 7.12088 10.6319L6.96805 6.49713L6.96811 6.49707C6.96672 6.42935 6.93777 6.36506 6.88787 6.3192C6.83791 6.27339 6.77146 6.24997 6.7038 6.25437C6.63687 6.2572 6.57379 6.28639 6.52834 6.33557C6.48283 6.38475 6.45869 6.44994 6.4611 6.51688L6.61393 10.6517C6.61712 10.7169 6.64517 10.7784 6.69236 10.8235C6.73949 10.8686 6.80215 10.894 6.8674 10.8944L6.8674 10.8944Z"
                  fill="#E41D1D"
                />
                <path
                  d="M8.85396 10.8944H8.86293C8.92975 10.8959 8.99445 10.8711 9.04321 10.8254C9.0919 10.7797 9.1208 10.7166 9.12362 10.6499L9.27646 6.51507H9.2764C9.27886 6.44814 9.25466 6.38295 9.20922 6.33377C9.16371 6.28459 9.10063 6.2554 9.03369 6.25257C8.96525 6.24553 8.89699 6.26762 8.84565 6.31348C8.79431 6.35929 8.76469 6.42466 8.76403 6.49353L8.60939 10.6283H8.60945C8.60602 10.6962 8.62998 10.7626 8.67597 10.8126C8.7219 10.8626 8.78606 10.8921 8.85396 10.8944L8.85396 10.8944Z"
                  fill="#E41D1D"
                />
              </svg>
            </ActionButton>
          </ActionContainer>
        );
      case UPLOAD_STATUS.failure:
        return (
          <ActionContainer>
            <ActionButton action={retryUpload}>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
              >
                <path
                  d="M7 22V19H19V13H17V17H7V14L3 18L7 22ZM21 6L17 2V5H5V11H7V7H17V10L21 6Z"
                  fill="#6D6D6D"
                />
              </svg>
            </ActionButton>
            <ActionButton action={deleteUpload}>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                viewBox="0 0 16 16"
                fill="none"
              >
                <circle cx="8" cy="8" r="8" fill="#FFF3F3" />
                <path
                  d="M11.4769 5.14517H10.4774C10.464 5.14054 10.4501 5.13753 10.436 5.13614H9.37174V4.25348C9.3718 4.18714 9.3458 4.12346 9.29945 4.07608C9.25304 4.02871 9.18995 4.00138 9.12369 4H6.60672C6.53948 4 6.47501 4.02667 6.42752 4.07422C6.37997 4.12177 6.35324 4.18624 6.35324 4.25348V5.13614H5.29439C5.2803 5.13753 5.2664 5.14054 5.25303 5.14517H4.25347C4.16288 5.14517 4.07921 5.19345 4.03395 5.27188C3.98868 5.35031 3.98868 5.44691 4.03395 5.52535C4.07921 5.60378 4.16288 5.65211 4.25347 5.65211H5.06783L5.72585 11.7735C5.7329 11.8358 5.76263 11.8933 5.8094 11.9351C5.85611 11.9769 5.91661 11.9999 5.97932 12H9.75462C9.81668 11.9991 9.87627 11.9756 9.92233 11.9339C9.96831 11.8922 9.99751 11.8352 10.0045 11.7735L10.6625 5.66105H11.4769C11.5675 5.66105 11.6511 5.61277 11.6964 5.53434C11.7417 5.45591 11.7417 5.35924 11.6964 5.28087C11.6511 5.20244 11.5675 5.1541 11.4769 5.1541L11.4769 5.14517ZM6.86566 4.50695H8.86472V5.13614H6.86566V4.50695ZM9.52455 11.4894H6.20582L5.57663 5.66111H10.1537L9.52455 11.4894Z"
                  fill="#E41D1D"
                />
                <path
                  d="M7.86529 10.8962C7.93252 10.8962 7.99699 10.8695 8.04454 10.822C8.09209 10.7745 8.11876 10.71 8.11876 10.6428V6.50796C8.11876 6.41737 8.07049 6.33369 7.99205 6.28843C7.91362 6.24311 7.81696 6.24311 7.73852 6.28843C7.66009 6.3337 7.61182 6.41737 7.61182 6.50796V10.6428C7.61182 10.71 7.63848 10.7745 7.68603 10.822C7.73359 10.8695 7.79805 10.8962 7.86529 10.8962H7.86529Z"
                  fill="#E41D1D"
                />
                <path
                  d="M6.8674 10.8944H6.87817C6.94511 10.8916 7.00819 10.8624 7.0537 10.8132C7.09915 10.7641 7.12334 10.6989 7.12088 10.6319L6.96805 6.49713L6.96811 6.49707C6.96672 6.42935 6.93777 6.36506 6.88787 6.3192C6.83791 6.27339 6.77146 6.24997 6.7038 6.25437C6.63687 6.2572 6.57379 6.28639 6.52834 6.33557C6.48283 6.38475 6.45869 6.44994 6.4611 6.51688L6.61393 10.6517C6.61712 10.7169 6.64517 10.7784 6.69236 10.8235C6.73949 10.8686 6.80215 10.894 6.8674 10.8944L6.8674 10.8944Z"
                  fill="#E41D1D"
                />
                <path
                  d="M8.85396 10.8944H8.86293C8.92975 10.8959 8.99445 10.8711 9.04321 10.8254C9.0919 10.7797 9.1208 10.7166 9.12362 10.6499L9.27646 6.51507H9.2764C9.27886 6.44814 9.25466 6.38295 9.20922 6.33377C9.16371 6.28459 9.10063 6.2554 9.03369 6.25257C8.96525 6.24553 8.89699 6.26762 8.84565 6.31348C8.79431 6.35929 8.76469 6.42466 8.76403 6.49353L8.60939 10.6283H8.60945C8.60602 10.6962 8.62998 10.7626 8.67597 10.8126C8.7219 10.8626 8.78606 10.8921 8.85396 10.8944L8.85396 10.8944Z"
                  fill="#E41D1D"
                />
              </svg>
            </ActionButton>
          </ActionContainer>
        );
    }
  }, [upload.status, retryUpload, upload.controller, deleteUpload]);

  return (
    <div className="relative h-auto pt-2  pb-[10px] rounded-[4px] bg-white border-solid border-[0.5px] border-[#E3E3E3]">
      <div className="px-[10px] flex justify-between">
        <div className="text-xs leading-[18px] font-normal text-[#0F0F0F]">
          {upload?.file?.name}
        </div>
        {renderIcon}
      </div>
      <div className="absolute -bottom-[2px] w-full h-[3px]">
        <div
          style={{ width: `${upload.progress}%` }}
          className="rounded-[10px] h-[3px] bg-[#483EA8]"
        ></div>
      </div>
    </div>
  );
};

export { Upload };
